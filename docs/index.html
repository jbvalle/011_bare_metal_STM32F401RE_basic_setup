<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bare Metal Blink Project: Bare Metal STM32</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bare Metal Blink Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Bare Metal STM32 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_strayker_Coding_046_bare_metal_STM32F401RE_basic_setup_README"></a> <a href="https://jbvalle.github.io/stm32_bare_metal_startup_linker.html"><img src="https://jbvalle.github.io/images/check_out_my_blog.png" alt="blog" class="inline"/></a></p>
<p>This project is about setting up a basic bare metal stm32 project. This project does not use any ide or third party libraries. The focus is on getting started with the stm32 platform and understanding the basics of how to set up a project without any abstractions.</p>
<p><img src="./img/stm32_bare_metal_make.gif" alt="flashing a stm32" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Contents</h1>
<ul>
<li><a href="#why">Why?</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#output-structure">Output Structure</a></li>
<li><a href="#want-to-learn-more">Want to learn more?</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md2"></a>
Why?</h3>
<p>Suppose you’ve ever wondered how to set up a bare metal register level C program for developing embedded systems without an IDE or libraries such as HAL or any other abstractions. In that case, this project is for you. In order to understand what is going on, I've provided a link at the top of the page that will take you to a blog post that will help you understand the project a little better.</p>
<p>There are lot of benefits to learning about this approach, and actually implementing a complete project without any abstractions like IDEs and third-party libraries, a few are:</p><ul>
<li>STM32 microcontrollers have a large number of registers, that can be used for various purposes, using this approach really forces one to understand the hardware and all its functionalities from the ground up</li>
<li>programming at this low level allows for more flexibility in how the MCU is used</li>
<li>register level bare metal programming can be used to optimize the MCU resources</li>
<li>using this approach can improve the performance of the MCU</li>
<li>this method can also be used to create custom peripherals and interfaces</li>
<li>lastly, it is a lot of fun! :)</li>
</ul>
<p><em>Why did I use Make over CMAKE?</em></p><ul>
<li>Make is more commonly used for firmware applications that are simple and do not require a lot of customization, while CMake is more commonly used for firmware applications that are more complex and require more customization. As my setup has a very small foot print and the goal was learning core principles of the build process, it made sense using make for my purposes.</li>
</ul>
<p><em>Why did I choose C over C++?</em></p><ul>
<li>When it comes to firmware applications in embedded systems, there is often a debate about whether to use c++ or c. Both have their pros and cons, so it really comes down to a matter of preference.</li>
<li>C++ has the advantage of being a more powerful programming language. It allows for more complex data structures and algorithms, which can be helpful in firmware applications. Additionally, c++ compilers are usually more optimized than c compilers, so code can run faster.</li>
<li>On the other hand, c is a simpler language and is often easier to learn and work with. Additionally, c code is often more readable than c++ code, which was helpful as this project was meant for educational purposes.</li>
</ul>
<p><em>Why did I not use SDKs, IDEs and any third party libraries?</em></p><ul>
<li>This project is not about avoiding tools and abstractions in general. This project is about understanding how things work behind the curtain in order to learn and understand what is usually hidden. By understanding the inner workings of something, we can often get a better grasp of the big picture.</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
### Installation Requirements</h2>
<blockquote class="doxtable">
<p><b>Warning</b> Please note that it has only been tested on Ubuntu 22.04, and further adjustments may be necessary for other systems. I would be grateful for any messages if you encounter any errors. Thank you! </p>
</blockquote>
<h4><a class="anchor" id="autotoc_md4"></a>
Install &lt;tt&gt;ARM GNU Toolchain&lt;/tt&gt;: &lt;a href="https://developer.arm.com/downloads/-/gnu-rm"&gt;&lt;tt&gt;Download Link&lt;/tt&gt;&lt;/a&gt;</h4>
<p>some additional recommended installations for the ARM GNU Toolchain: </p><div class="fragment"><div class="line">$ sudo apt-get install build-essential libgmp3-dev libmpfr-dev libx11-6 libx11-dev texinfo flex bison libmpc-dev libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev zlibc </div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md5"></a>
Install &lt;tt&gt;openocd&lt;/tt&gt;</h4>
<div class="fragment"><div class="line">$ sudo apt-get install -y openocd</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md6"></a>
Install &lt;tt&gt;stlink-tools&lt;/tt&gt;</h4>
<div class="fragment"><div class="line">$ sudo apt-get install -y stlink-tools</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md7"></a>
Install &lt;tt&gt;gdb-multiarch&lt;/tt&gt;</h4>
<div class="fragment"><div class="line">$ sudo apt-get install -y gdb-multiarch</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
### Usage</h2>
<div class="fragment"><div class="line">Usage: make [TARGETS]</div>
<div class="line"> </div>
<div class="line">Targets:</div>
<div class="line">  -all                        Generate object files and executable</div>
<div class="line">  -flash                      Call OpenOCD, call gdb-multiarch, flash elf file using st-link-v2 debugger</div>
<div class="line">  -debug                      Call OpenOCD, call gdb-multiarch, debug main elf file</div>
<div class="line">  -doxy                       Generate Documentation files using Doxygen</div>
<div class="line">  -clean                      Delete all object and elf files</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
#### Output Structure</h2>
<div class="fragment"><div class="line">./</div>
<div class="line">├── debug/</div>
<div class="line">│   ├── main.elf</div>
<div class="line">│   └── main.map</div>
<div class="line">│</div>
<div class="line">├── docs/</div>
<div class="line">│   ├── html/</div>
<div class="line">│   │   └── ...</div>
<div class="line">│   ├── latex/</div>
<div class="line">│   │   └── ...</div>
<div class="line">│   └── Doxygen</div>
<div class="line">│</div>
<div class="line">├── inc/</div>
<div class="line">│   └── peripherals.h</div>
<div class="line">│</div>
<div class="line">├── src/</div>
<div class="line">│   ├── obj/</div>
<div class="line">│   │   ├── main.o</div>
<div class="line">│   │   └── startup_STM32F401RE.o</div>
<div class="line">│   └── main.c</div>
<div class="line">│</div>
<div class="line">├── startup/</div>
<div class="line">│   ├── debug.gdb</div>
<div class="line">│   ├── flash.gdb</div>
<div class="line">│   ├── linkerscript_STM32F401RE.ld</div>
<div class="line">│   └── startup_STM32F401RE.c</div>
<div class="line">│</div>
<div class="line">└── Makefile</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
### Want to learn more?</h2>
<p><a href="https://jbvalle.github.io/stm32_bare_metal_startup_linker.html"><img src="https://jbvalle.github.io/images/check_out_my_blog.png" alt="blog" class="inline"/></a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
